<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BookMyCut - {% block title %}Welcome{% endblock %}</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <!-- FontAwesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Flatpickr Date Picker -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/themes/dark.css">

    <!-- Theme Detection (Blocking) -->
    <script>
        (function () {
            const savedTheme = localStorage.getItem('theme') || 'dark';
            document.documentElement.setAttribute('data-theme', savedTheme);
        })();
    </script>
</head>

<body>
    <!-- Aurora Background -->
    <div class="aurora-background-container">
        <div class="aurora-blob aurora-blob-1"></div>
        <div class="aurora-blob aurora-blob-2"></div>
        <div class="aurora-blob aurora-blob-3"></div>
    </div>
    <div class="dot-grid"></div>

    <!-- Mouse Tracking Background -->
    <div class="mouse-follower-bg"></div>

    <!-- Navigation -->
    {% if request.endpoint in ['login', 'register'] %}
    {% include 'includes/nav_auth.html' %}
    {% elif session.loggedin %}
    {% include 'includes/nav_dashboard.html' %}
    {% else %}
    {% include 'includes/nav_main.html' %}
    {% endif %}

    <!-- Flash Messages -->
    <div class="container content-wrapper">
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
        {% for category, message in messages %}
        <div class="alert alert-{{ category }} alert-dismissible fade show glass-card animate-float border-primary border-opacity-10"
            role="alert" style="background: rgba(15, 23, 42, 0.9); color: white;">
            <i
                class="fas fa-{{ 'check-circle' if category == 'success' else 'exclamation-circle' }} me-2 text-{{ category }}"></i>
            {{ message }}
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        {% endfor %}
        {% endif %}
        {% endwith %}
    </div>

    <!-- Main Content -->
    <main class="container mt-4 pb-5">
        {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer class="text-white py-5 mt-auto glass-card rounded-0 border-0 border-top"
        style="background: rgba(15, 23, 42, 0.9); border-color: rgba(139, 92, 246, 0.1) !important;">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-6 text-center text-md-start mb-4 mb-md-0">
                    <a class="navbar-brand d-flex align-items-center fw-bold fs-4 mb-3" href="{{ url_for('index') }}"
                        style="letter-spacing: -1px;">
                        <span class="text-primary me-1"><i class="fas fa-cut"></i></span>
                        <span class="text-white">BookMy<span class="text-primary">Cut</span></span>
                    </a>
                    <p class="text-muted small mb-0">Elevating the grooming experience through seamless digital booking.
                        Style, precision, and convenience redefined.</p>
                </div>
                <div class="col-md-6 text-center text-md-end">
                    <div class="d-flex justify-content-center justify-content-md-end gap-3 mb-3">
                        <a href="#" class="text-muted hover-primary"><i class="fab fa-instagram fa-lg"></i></a>
                        <a href="#" class="text-muted hover-primary"><i class="fab fa-twitter fa-lg"></i></a>
                        <a href="#" class="text-muted hover-primary"><i class="fab fa-facebook fa-lg"></i></a>
                    </div>
                    <p class="mb-0 text-muted small">&copy; 2026 BookMyCut. <span class="text-primary">Crafted for
                            Excellence.</span></p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap 5 JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    <script src="{{ url_for('static', filename='js/mouse-tracking.js') }}"></script>
    <!-- Theme Toggle Script -->
    <script>
        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateToggleIcons(newTheme);
        }

        function updateToggleIcons(theme) {
            const icons = document.querySelectorAll('.theme-toggle-icon');
            icons.forEach(icon => {
                icon.className = theme === 'dark' ? 'fas fa-moon theme-toggle-icon' : 'fas fa-sun theme-toggle-icon';
            });

            const tooltips = document.querySelectorAll('.theme-toggle-text');
            tooltips.forEach(text => {
                text.textContent = theme === 'dark' ? 'Dark Mode' : 'Light Mode';
            });
        }

        // Initialize icons on load
        document.addEventListener('DOMContentLoaded', () => {
            const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';
            updateToggleIcons(currentTheme);

            // Re-apply mouse follower if needed or other theme-specific JS
        });
    </script>
    <!-- Flatpickr JS -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    {% block scripts %}{% endblock %}
</body>

</html>